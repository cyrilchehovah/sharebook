<!-- Banner -->
<div class="banner-top" style='background-image: url("<%= image_url("banner-home.jpg") %>")'>
  <div class="bg-filter bg-gradient"></div>
  <div class="container">
    <div class="row">
      <div class="col-xs-12">
        <h1>La bibliothèque</h1>
      </div>
    </div>
  </div>
</div>

<div class="container padded">
  <div class="row">
    <div class="col-xs-12 col-sm-10 col-sm-offset-1">
      <div class="row">
        <div class="col-xs-10 col-xs-offset-1">
          <h2 class="text-center">Retrouvez des livres spécialisés dans le web en fouillant la bibliothèque de vos voisins</h2>
        </div>
      </div>

      <form>
        <div class="input-group">
          <input id="search-input" type="text" autocomplete="off" spellcheck="false" autocorrect="off" class="form-control input-lg" placeholder="HTML5 pour les web designers">
          <span class="input-group-btn">
            <button class="btn btn-primary btn-lg" type="button"><i class="fa fa-search"></i></button>
          </span>
        </div><!-- /input-group -->

      </form>
    </div>
  </div>
</div>

<div class="container">
  <main>
    <!-- Left Column -->
    <div id="left-column">
      <div id="facets"></div>
    </div>

    <!-- Right Column -->
    <div id="right-column">
      <div id="stats"></div>
      <div id="hits">
      </div>
      <div id="pagination"></div>
    </div>
  </main>
</div>


<% content_for :after_js do %>
  <script>
      var $input = $('input');
      var $hits = $('#hits');


      $(document).ready(function() {
        var client = algoliasearch('LNZ38F4R3P', '44638aca0bf25d6a95b4fdeb148d36c7');
        var index = client.initIndex('Book');

        function algoliaSearch() {
          index.search($input.val(), {
            "getRankingInfo": 1,
              "facets": "*",
              "attributesToRetrieve": "*",
              "highlightPreTag": "<em>",
              "highlightPostTag": "</em>",
              "hitsPerPage": 10,
              "aroundLatLng": "48.8648482,2.3798534",
              "aroundRadius": 10,
              "facetFilters": [],
              "maxValuesPerFacet": 100
          }, searchCallback);
        }

        algoliaSearch();

        $input.keyup(function() {
          algoliaSearch();
        }).focus();
      });

      function searchCallback(err, content) {
        if (err) {
          console.error(err);
          return;
        }

        $hits.empty();

        for (var i = 0; i < content.hits.length; i++) {
          $hits.append('<img src=' + content.hits[i].image + '>');
          $hits.append('<h2>' + content.hits[i].title + '</h2>');
          $hits.append('<h4>' + content.hits[i].author + '</h4>');
        }
      };

    </script>

<% end %>

